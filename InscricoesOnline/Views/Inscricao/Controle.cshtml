@model List<InscricoesOnline.Models.Chave>

@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div id="page-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <h3 class="page-header">
                <small>
                    <a class="text-primary" href="@Url.Action("Index", "Admin")"><i class="fa fa-home fa-fw"></i>Início</a>
                    <span class="text-muted">/</span>
                    <span class="text-muted"><a class="text-primary" href="@Url.Action("Eventos", "Inscricao" )">Eventos</a></span>
                    <span class="text-muted">/</span>
                    <span class="text-muted"><a class="text-primary" href="@Url.Action("Lista", "Inscricao", new { id = Model.First().Evento.Id })">@Model.First().Evento.Titulo</a></span>
                    <span class="text-muted">/</span>
                    <span class="text-muted">Controle</span>
                </small>
            </h3>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <section class="panel panel-info">
                <header class="panel-heading">
                    <i class="fa fa-list"></i> Lista de chaves - <strong>@Model.Count() registros</strong>
                </header>

                <div class="panel-body">
                    <div class="pad-bot-15 text-center">
                        <a href="@Url.Action("Desclassificar", "Inscricao", new { id = Model.First().Evento.Id })" class="btn btn-danger"><i class="fa fa-ban"></i> Desclassificar Atletas</a>
                    </div>
                </div>

                <div class="panel-body">
                    @foreach (var chave in Model)
                    {
                        <section class="panel panel-info">
                            <div class="pad-bot-15 text-center">
                                <h2>
                                    @chave.Modalidade.Titulo @(" - ") @chave.CategoriaIdade.Titulo @(" - ") @chave.CategoriaFaixa.Titulo @(chave.CategoriaLutaPeso == null ? "" : " - " + chave.CategoriaLutaPeso.Titulo)
                                </h2>
                            </div>

                            <div id="DataTables_Table_0_wrapper" class="dataTables_wrapper form-inline dt-bootstrap no-footer">
                                <div class="col-sm-12 table-responsive">

                                    <table class="fp-table table table-striped table-bordered table-hover" id="DataTables_Table_0" role="grid" aria-describedby="DataTables_Table_0_info">
                                        <thead>
                                            <tr role="row">
                                                <th>Filiado</th>
                                                <th>Academia</th>
                                                <th>Categoria de Peso</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var participante in chave.ChaveParticipantes.OrderByDescending(c => c.Ativo).ThenBy(c => c.Colocacao))
                                            {
                                                <tr id="@chave.Id" role="row" style="background-color: @(chave.ChaveParticipantes.Count() != @chave.Inscritos.Count() ? "#f2dede" : "")">
                                                    <td> @Html.DisplayFor(modelItem => participante.InscricaoModalidade.Inscricao.Filiado.Nome) </td>
                                                    <td> @Html.DisplayFor(modelItem => participante.InscricaoModalidade.Inscricao.Academia.Nome) </td>
                                                    <td> @Html.DisplayFor(modelItem => participante.Colocacao) </td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="pad-bot-15 text-center">
                                <a href="@Url.Action("Classificar", "Inscricao", new { id = chave.Id })" class="btn btn-warning"><i class="fa fa-sort-numeric-asc"></i> Classificar</a>
                            </div>
                        </section>
                    }
                </div>
            </section>
        </div>
    </div>
</div>

<div class="modal fade" id="mod-gerar-chave" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary">
                <h4 class="modal-title text-primary" id="mod-excluir-label">ATENÇÃO</h4>
            </div>
            <div class="modal-body">
                A geração de chaves apagará as chaves geradas anteriormente,
                deseja realmente gerar todas as chaves deste evento?
            </div>
            <div class="modal-footer">
                <div class="form-actions no-color">
                    <a href="#" class="btn btn-primary mod-gerar-chave-a"><i class="fa fa-check-circle"></i> Sim</a>
                    <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times-circle"></i> Cancelar</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="mod-aviso" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-warning">
                <h4 class="modal-title text-warning" id="mod-excluir-label">ATENÇÃO</h4>
            </div>
            <div class="modal-body">
                Não há atletas inscritos nessa categoria.
            </div>
            <div class="modal-footer">
                <div class="form-actions no-color">
                    <a href="#" class="btn btn-warning" data-dismiss="modal"><i class="fa fa-check-circle"></i> Ok</a>
                </div>
            </div>
        </div>
    </div>
</div>